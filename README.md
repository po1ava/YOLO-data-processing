# YOLO模型训练与图像数据处理
本项目为YOLO数据处理与模型训练提供了多种便捷的工具，包括数据集划分、标签数据更改、图像数据增强、模型格式转换等功能。

## 数据集划分
**data_division. py** 程序提供了数据集划分功能，输入路径即可按照预定的划分比例将图片划分至训练集、验证集、测试集文件夹。
```
example/ （运行前）
├── images/ 
└── labels/ 
```
```
example/ （运行后）
├── train/ 
│   ├── images/  
│   └── labels/  
├── val/ 
│   ├── images/  
│   └── labels/  
└── test/ 
    ├── images/ 
    └── labels/
```

## 指定类别标签删除
**label_deletion. py** 程序提供了指定类别标签删除功能，能够删除数据集中特定类别的所有标签，其余类别标签信息保持不变。这一程序可以用于数据集的分类训练，解决不同类别图像差异较大/数据分布不平衡/特定类别标签需要深度优化等问题。

## 背景图片清理
**background_deletion. py** 程序提供了背景图片清理功能，能够删除指定比例的背景图片（无标签图片）与其标签文件，其余文件保持不变。这一程序通常与 **label_deletion.py** 搭配使用，在删除指定类别标签后背景图片数量增多，运行这一程序以控制背景图片在数据集中的比例。

## 目标检测转化为图片分类
**detection2classification. py** 程序能够将所有具有指定类型标签的图片转移到新文件夹中，其余图片与标签文件保持不动，用于将目标检测数据集转化为图片分类数据集。

**使用例**：在文物病害图像识别模型训练过程中，“变色与沉积”这一病害类别标签数量较多，目标框在图片中所占比例较大，与其余类别有显著差异。因此考虑将其单独训练：使用 **label_deletion. py** 删除此类别标签，并使用 **background_deletion. py** 清除多余背景图片，达到去除此类标签数据的效果；在备份的数据集中，使用 **detection2classification. py** 将具有此类标签的图片单独取出，其余图片作为背景图片，对处理后数据集进行图片分类训练，显著提高了病害识别精度。

![输入图片说明](/pic.png)

## 图像数据增强
**data_augmentation. py** 程序提供了图像数据增强功能，能够调用albumentations库便捷地以指定的增强因子数量与各个图像处理方式概率执行图像数据增强操作。

## 模型格式转换
**pt2onnx. py** 程序提供了将 .pt 后缀的模型文件转化为 .onnx 后缀的模型文件，能够用于在 X-AnyLabeling 等标注软件中导入自定义模型，使用模型辅助人工标注，加快图像数据集标注过程。



 






